/**
 * # wrap/jquery
 *
 * Wrap global instance for use in RequireJS modules
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # wrap/modernizr
 *
 * Wrap global instance for use in RequireJS modules
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/* Copyright (c) 2010-2012 Marcus Westin */

/**
 * # util/util
 *
 * This is the home for wayward methods who have lost their way.
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * Adapted from the official plugin text.js
 *
 * Uses UnderscoreJS micro-templates : http://documentcloud.github.com/underscore/#template
 * @author Julien Cabanès <julien@zeeagency.com>
 * @version 0.2
 *
 * @license RequireJS text 0.24.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/**
 * # util/templates
 *
 * Utility methods for referencing js templates
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # manager/file
 *
 * Methods for loading files to the canvas and giving updates on their
 * progress
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # layout/base
 *
 * Base constructor for the canvas layout managers. Used to determine
 * canvas dimensions and to place sprites without intersections (overlap)
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # layout/compact
 *
 * Constructor for the compact canvas layout manager. Used to determine
 * canvas dimensions and to place sprites without intersections (overlap).
 * Places sprites in the most compact rectangle possible
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # layout/vertical
 *
 * Constructor for the vertical canvas layout manager. Used to determine
 * canvas dimensions and to place sprites without intersections (overlap).
 * Places sprites in a vertical column
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # layout/horizontal
 *
 * Constructor for the horizontal canvas layout manager. Used to determine
 * canvas dimensions and to place sprites without intersections (overlap).
 * Places sprites in a horizontal row
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # manager/layout
 *
 * Methods for setting the canvas layout and stitching the sprites together
 * (i.e. placing them on the canvas)
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # stylesheet/base
 *
 * Base constructor for the stylesheet managers
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # stylesheet/css
 *
 * Base constructor for the CSS stylesheet manager
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # stylesheet/less
 *
 * Base constructor for the LESS stylesheet manager
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # manager/stylesheet
 *
 * Methods for setting the canvas stylesheet type and making the stylesheets
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # module/drop-box
 *
 * Constructor for the drag and drop element. Used to allow users to drag
 * files onto a DOM element to initiate processing
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # util/array
 *
 * Utility methods for working with arrays
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # module/sprite
 *
 * Constructor for the sprite element, which holds sprite dimensions,
 * position, and display info. Used for manipulation of a single
 * sprite on the canvas
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # module/canvas
 *
 * Constructor for the sprite sheet canvas element, which holds and displays
 * all placed sprites. Used for manipulating sprite placement and
 * state
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # module/toolbar
 *
 * Constructor for UI toolbars
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # module/palette
 *
 * Constructor for UI palettes (i.e. dialogs). Inherits from `Toolbar`
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # module/stitches
 *
 * Constructor for the stitches module, which encapsulates all of the UI
 * functionality. Instantiated with a DOM element, into which all of the
 * markup is injected and to which the behaviors are attached. Typically
 * used in a DOM ready callback
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 */

/**
 * # Stitches
 *
 * ### _An HTML5 Sprite Sheet Generator_
 *
 * > http://draeton.github.io/stitches<br/>
 * > Copyright 2013 Matthew Cobbs<br/>
 * > Licensed under the MIT license.
 *
 * Stitches is an HTML5 sprite sheet generator.
 *
 * Stitches is developed by Matthew Cobbs in concert with the lovely open-source
 * community at Github. Thanks are owed to the developers at Twitter for
 * [Bootstrap](http://twitter.github.io/bootstrap), and
 * [Glyphicons](http://glyphicons.com/) for some cool little icons.
 *
 * Addtionally, I want to thank [James Taylor](https://github.io/jbt)
 * for the [Docker](https://github.io/jbt/docker) documentation tool, and most
 * of all the good folks who develop [RequireJS](http://requirejs.org/) and
 * [GruntJS](http://gruntjs.com/), for helping this all make sense.
 */

define("wrap/jquery",[],function(){"use strict";return jQuery}),define("wrap/modernizr",[],function(){"use strict";return Modernizr}),function(){function o(){try{return r in t&&t[r]}catch(e){return!1}}var e={},t=window,n=t.document,r="localStorage",i="__storejs__",s;e.disabled=!1,e.set=function(e,t){},e.get=function(e){},e.remove=function(e){},e.clear=function(){},e.transact=function(t,n,r){var i=e.get(t);r==null&&(r=n,n=null),typeof i=="undefined"&&(i=n||{}),r(i),e.set(t,i)},e.setAll=function(){},e.getAll=function(){},e.serialize=function(e){return JSON.stringify(e)},e.deserialize=function(e){if(typeof e!="string")return undefined;try{return JSON.parse(e)}catch(t){return e||undefined}};if(o())s=t[r],e.set=function(t,n){return typeof t=="object"?e.setAll(t):n===undefined?e.remove(t):(s.setItem(t,e.serialize(n)),n)},e.get=function(t){return t===undefined?e.getAll():e.deserialize(s.getItem(t))},e.remove=function(e){s.removeItem(e)},e.clear=function(){s.clear()},e.setAll=function(t){for(var n in t)t[n]=e.set(n,t[n])},e.getAll=function(){var t={};for(var n=0;n<s.length;++n){var r=s.key(n);t[r]=e.get(r)}return t};else if(n.documentElement.addBehavior){var u,a;try{a=new ActiveXObject("htmlfile"),a.open(),a.write('<script>document.w=window</script><iframe src="/favicon.ico"></frame>'),a.close(),u=a.w.frames[0].document,s=u.createElement("div")}catch(f){s=n.createElement("div"),u=n.body}function l(t){return function(){var n=Array.prototype.slice.call(arguments,0);n.unshift(s),u.appendChild(s),s.addBehavior("#default#userData"),s.load(r);var i=t.apply(e,n);return u.removeChild(s),i}}var c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function h(e){return e.replace(c,"___")}e.set=l(function(t,n,i){return typeof n=="object"?e.setAll(n):(n=h(n),i===undefined?e.remove(n):(t.setAttribute(n,e.serialize(i)),t.save(r),i))}),e.get=l(function(t,n){return n===undefined?e.getAll():(n=h(n),e.deserialize(t.getAttribute(n)))}),e.remove=l(function(e,t){t=h(t),e.removeAttribute(t),e.save(r)}),e.clear=l(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(r);for(var n=0,i;i=t[n];n++)e.removeAttribute(i.name);e.save(r)}),e.setAll=l(function(t,n){for(var r in n)n[r]=e.set(r,n[r]);return n}),e.getAll=l(function(t){var n=t.XMLDocument.documentElement.attributes;t.load(r);var i={};for(var s=0,o;o=n[s];++s)i[o]=e.get(o);return i})}try{e.set(i,i),e.get(i)!=i&&(e.disabled=!0),e.remove(i)}catch(f){e.disabled=!0}e.enabled=!e.disabled,typeof module!="undefined"&&typeof module!="function"?module.exports=e:typeof define=="function"&&define.amd?define("module/../../../libs/store/store",e):this.store=e}(),define("util/util",["wrap/jquery"],function(e){"use strict";return{inherit:function(t,n,r){t.prototype=new n,t.prototype.constructor=n,e.each(r,function(e,n){t.prototype[e]=n}),t.prototype._super=function(e,t,r){var i=n.prototype[e];return i.apply(t,r)}},debounce:function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){n||e.apply(i,s),r=null};r?window.clearTimeout(r):n&&e.apply(i,s),r=setTimeout(o,t||50)}},noop:function(e){e&&(e.preventDefault(),e.stopPropagation())},toPx:function(e){return e?e+"px":"0"}}}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=[],i={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},s=function(e,t){var n=i,r="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(n.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(n.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"; __p.push('"}).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"")+"');}return __p.join('');";return r};define("tpl",[],function(){var i,o,u;return typeof window!="undefined"&&window.navigator&&window.document?o=function(e,t){var n=i.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(e){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node&&(u=require.nodeRequire("fs"),o=function(e,t){t(u.readFileSync(e,"utf8"))}),i={version:"0.24.0",strip:function(e){if(e){e=e.replace(t,"");var r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"").replace(/[\t]/g,"").replace(/[\r]/g,"")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw new Error("require.getXhr(): XMLHttpRequest not available");return t},get:o,load:function(e,t,n,o){var u=!1,a,f=e.indexOf("."),l=e.substring(0,f),c=e.substring(f+1,e.length);f=c.indexOf("!"),f!==-1&&(u=c.substring(f+1,c.length),u=u==="strip",c=c.substring(0,f)),a="nameToUrl"in t?t.nameToUrl(l,"."+c):t.toUrl(l+"."+c),i.get(a,function(t){t=s(t),o.isBuild||(t=new Function("obj",t)),t=u?i.strip(t):t,o.isBuild&&o.inlineText&&(r[e]=t),n(t)})},write:function(e,t,n){if(t in r){var s=i.jsEscape(r[t]);n("define('"+e+"!"+t+"', function() {return function(obj) { "+s.replace(/(\\')/g,"'").replace(/(\\\\)/g,"\\")+"}});\n")}}}})}(),define("tpl!util/../../templates/stitches.tpl",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="stitches">    <!-- .stitches-toolbar -->    <div class="stitches-toolbar btn-toolbar">        <div class="btn-group">            <button data-action="open" class="btn btn-small btn-info files" title="添加图片素材">                <i class="icon-folder-open icon-white"></i> <span class="hidden-phone">添加</span><input class="file" type="file" multiple="multiple">            </button>            <button data-action="settings" class="btn btn-small btn-info" title="设置布局、样式前缀、间距...">                <i class="icon-cog icon-white"></i> <span class="hidden-phone">设置</span>            </button>            <button data-action="clear" class="btn btn-small btn-info disabled" title="清空所有图片">                <i class="icon-remove icon-white"></i> <span class="hidden-phone">清空</span>            </button>        </div>        <div class="btn-group">            <button data-action="downloads" class="btn btn-small btn-success disabled" title="下载拼合好的图片和样式">                <i class="icon-download-alt icon-white"></i> <span class="hidden-phone">下载</span>            </button>        </div>        <div class="btn-group">            <button data-action="about" class="btn btn-small btn-info" title="关于程序">                <i class="icon-info-sign icon-white"></i> <span class="hidden-phone">关于</span>            </button>        </div>    </div>    <!-- /.stitches-toolbar -->    <!-- .stitches-progress -->    <div class="stitches-progress collapse">        <div class="progress progress-warning">            <div class="bar" style="width: 0%;"></div>        </div>    </div>    <!-- /.stitches-progress -->    <!-- .stitches-drop-box -->    <div class="stitches-drop-box">        <div class="stitches-overlay"></div>        <div class="stitches-wrap">            <!-- .stitches-canvas -->            <div class="stitches-canvas"></div>            <!-- /.stitches-canvas -->        </div>        <!-- .stitches-palettes -->        <div class="stitches-palettes">            <!-- .stitches-settings -->            <div class="stitches-palette stitches-settings fade">                <div class="stitches-palette-header">                    <button type="button" class="close" data-action="close" title="关于">&times;</button>                    <h4>设置</h4>                </div>                <div class="stitches-palette-body">                    <ul class="nav nav-tabs">                        <li class="active"><a href="#general" data-toggle="tab">通用</a></li>                        <li><a href="#import" data-toggle="tab">导入</a></li>                    </ul>                    <form class="form-horizontal">                        <div class="tab-content">                            <div class="tab-pane active" id="general">                                <div class="control-group hide">                                    <label class="control-label">位置</label>                                    <div class="controls">                                        <label class="checkbox">                                            <input name="position" type="checkbox" value="auto"/> 自动                                        </label>                                    </div>                                </div>                                <div class="control-group">                                    <label class="control-label">布局</label>                                    <div class="controls">                                        <label class="radio inline">                                            <input name="layout" type="radio" value="compact"/> 紧凑                                        </label>                                        <label class="radio inline">                                            <input name="layout" type="radio" value="vertical"/> 排成一列                                        </label>                                        <label class="radio inline">                                            <input name="layout" type="radio" value="horizontal"/> 排成一行                                        </label>                                    </div>                                </div>                                <div class="control-group">                                    <label class="control-label">输出格式</label>                                    <div class="controls">                                        <label class="radio inline">                                            <input name="stylesheet" type="radio" value="css"/> CSS                                        </label>                                        <label class="radio inline">                                            <input name="stylesheet" type="radio" value="less"/> LESS                                        </label>                                    </div>                                </div>                                <div class="control-group">                                    <label class="control-label">样式前缀</label>                                    <div class="controls">                                        <input name="prefix" type="text" placeholder="样式前缀&hellip;">                                    </div>                                </div>                                <div class="control-group">                                    <label class="control-label">间距</label>                                    <div class="controls">                                        <div class="input-append">                                            <input name="padding" type="number" min="0" required placeholder="Sprite padding&hellip;">                                            <span class="add-on">px</span>                                        </div>                                    </div>                                </div>                                <div class="control-group">                                    <label class="control-label">Data URI</label>                                    <div class="controls">                                        <label class="checkbox">                                            <input name="uri" type="checkbox" value="true"/> 在样式中包含编码后的图片                                        </label>                                    </div>                                </div>                            </div>                            <div class="tab-pane" id="import">                                <div class="control-group">                                    <label class="control-label">根据样式导入图片</label>                                    <div class="controls">                                        <textarea name="import" rows="10"></textarea>                                    </div>                                </div>                            </div>                        </div>                    </form>                </div>                <div class="stitches-palette-footer">                    <div class="btn-toolbar">                        <div class="btn-group">                            <a href="#" class="downloads-export btn btn-small btn-success" download="stitches"><i class="icon-download-alt icon-white"></i> 导入</a>                        </div>                        <div class="btn-group">                            <button class="btn btn-small btn-info" data-action="close" title="Save"><span>保存</span></button>                            <button class="btn btn-small btn-info" data-action="close" title="Close"><span>关闭</span></button>                        </div>                    </div>                </div>            </div>            <!-- /.stitches-settings -->            <!-- .stitches-properties -->            <div class="stitches-palette stitches-properties fade">                <div class="stitches-palette-header">                    <button type="button" class="close" data-action="close" title="关闭">&times;</button>                    <h4>图片属性</h4>                </div>                <div class="stitches-palette-body">                    <form class="form-horizontal">                        <div class="control-group">                            <label class="control-label">名称</label>                            <div class="controls">                                <input name="name" type="text" required placeholder="图片名称&hellip;">                            </div>                        </div>                        <div class="control-group">                            <label class="control-label">坐标 (x, y)</label>                            <div class="controls">                                <div class="input-append">                                    <input name="x" required disabled placeholder="From left&hellip;" class="input-mini">                                    <span class="add-on">px</span>                                </div>                                <div class="input-append">                                    <input name="y" required disabled placeholder="From top&hellip;" class="input-mini">                                    <span class="add-on">px</span>                                </div>                            </div>                        </div>                    </form>                </div>                <div class="stitches-palette-footer">                    <div class="btn-toolbar">                        <div class="btn-group">                            <button class="btn btn-small btn-danger" data-action="remove" title="Delete"><span>删除</span></button>                            <button class="btn btn-small btn-info" data-action="close" title="Save"><span>保存</span></button>                            <button class="btn btn-small btn-info" data-action="close" title="Close"><span>关闭</span></button>                        </div>                    </div>                </div>            </div>            <!-- /.stitches-properties -->            <!-- .stitches-about -->            <div class="stitches-palette stitches-about fade in">                <div class="stitches-palette-header">                    <button type="button" class="close" data-action="close" title="关闭">&times;</button>                    <h4>工具介绍</h4>                </div>                <div class="stitches-palette-body">                    <p><a href="http://draeton.github.io/stitches/">Stitches<a/> is an HTML5 <a href="http://en.wikipedia.org/wiki/Sprite_(computer_graphics)#Sprites_by_CSS">sprite sheet</a> generator.</p>                    <p>Drag &amp; drop image files onto the space below, or use the &ldquo;Open&rdquo; link to load images using the file browser. Then, click &ldquo;Generate&rdquo; to create a sprite sheet and stylesheet. <em>This demo uses a couple of HTML5 APIs, and it is only currently compatible with WebKit and Firefox browsers.</em></p>                    <p>Stitches is developed by <a href="http://draeton.github.io">Matthew Cobbs</a> in concert with the lovely open-source community at <a href="http://github.io">Github</a>. Thanks are owed to the developers at Twitter for <a href="http://twitter.github.io/bootstrap">Bootstrap</a>, and <a href="http://glyphicons.com/">Glyphicons</a> for some cool little icons.</p>                    <p class="text-right"><small>Copyright &copy; 2013 Matthew Cobbs<br/>                        Licensed under the MIT license.</small></p>                </div>                <div class="stitches-palette-footer">                    <div class="btn-toolbar">                        <div class="btn-group">                            <button class="btn btn-small btn-info" data-action="close" title="Close"><span>关闭</span></button>                        </div>                    </div>                </div>            </div>            <!-- /.stitches-about -->            <!-- .stitches-downloads -->            <div class="stitches-palette stitches-downloads fade">                <div class="stitches-palette-header">                    <button type="button" class="close" data-action="close" title="关闭">&times;</button>                    <h4>下载</h4>                </div>                <div class="stitches-palette-body">                    <section></section>                </div>                <div class="stitches-palette-footer">                    <div class="btn-toolbar">                        <div class="btn-group">                            <a href="#" class="downloads-spritesheet btn btn-small btn-success" download="spritesheet"><i class="icon-download-alt icon-white"></i> 拼合图片</a>                            <a href="#" class="downloads-stylesheet btn btn-small btn-success" download="stylesheet"><i class="icon-download-alt icon-white"></i> 样式表</a>                            <button class="btn btn-small btn-info" data-action="close" title="关闭"><span>关闭</span></button>                        </div>                    </div>                </div>            </div>            <!-- /.stitches-downloads -->        </div>        <!-- /.stitches-palettes -->    </div>    <!-- /.stitches-drop-box --></div>');return __p.join("")}}),define("tpl!util/../../templates/downloads.tpl",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<ul class="nav nav-tabs">    <li class="active"><a href="#spritesheet" data-toggle="tab">PNG</a></li>    <li><a href="#stylesheet" data-toggle="tab">',stylesheetType.toUpperCase(),'</a></li>    <li><a href="#markup" data-toggle="tab">HTML</a></li>    <li><a href="#example" data-toggle="tab"><strong>示例</strong></a></li></ul><div class="tab-content">    <div class="tab-pane active" id="spritesheet">        <p><img src="',spritesheet,'" class="thumbnail"/></p>    </div>    <div class="tab-pane" id="stylesheet">        <p><textarea rows="',stylesheetLines,'">',stylesheet,'</textarea></p>    </div>    <div class="tab-pane" id="markup">        <p><textarea rows="',markupLines,'">',markup,'</textarea></p>    </div>    <div class="tab-pane stitches-example" id="example">        <style type="text/',stylesheetType,'">',stylesheetWithUri,"</style>        <div>",markupTooltip,'</div>        <script src="libs/less.min.js"></script>    </div></div>');return __p.join("")}}),define("tpl!util/../../templates/sprite.tpl",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="stitches-sprite" style="top: ',y,"px; left: ",x,'px;">    <img src="',image.src,'"/></div>');return __p.join("")}}),define("tpl!util/../../templates/css.tpl",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(".",prefix," {\\n    background-image: url(",backgroundImage,");\\n    background-repeat: no-repeat;\\n    display: block;\\n}\\n"),$.map(sprites,function(e){__p.push("\\n.",prefix,"-",e.name," {\\n    width: ",e.image.width,"px;\\n    height: ",e.image.height,"px;\\n    background-position: ",e.left(!0)," ",e.top(!0),";\\n}\\n")}),__p.push("");return __p.join("")}}),define("tpl!util/../../templates/css-markup.tpl",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(""),$.map(sprites,function(e){__p.push(""),tooltip?__p.push('<i class="',prefix," ",prefix,"-",e.name,'" data-toggle="tooltip" title=".',prefix,".",prefix,"-",e.name,'"></i>\\n'):__p.push('<i class="',prefix," ",prefix,"-",e.name,'"></i>\\n'),__p.push("")}),__p.push("");return __p.join("")}}),define("tpl!util/../../templates/less.tpl",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(".stitches-",prefix,"(@x: 0, @y: 0, @width: 0, @height: 0) {\\n    background-position: @x @y;\\n    width: @width;\\n    height: @height;\\n}\\n\\n.",prefix," {\\n    background-image: url(",backgroundImage,");    background-repeat: no-repeat;\\n    display: block;\\n"),$.map(sprites,function(e){__p.push("\\n    &.",prefix,"-",e.name," {\\n        .stitches-",prefix,"(",e.left(!0),", ",e.top(!0),", ",e.image.width,"px, ",e.image.height,"px);\\n    }\\n")}),__p.push("}\\n");return __p.join("")}}),define("tpl!util/../../templates/less-markup.tpl",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(""),$.map(sprites,function(e){__p.push(""),tooltip?__p.push('<i class="',prefix," ",prefix,"-",e.name,'" data-toggle="tooltip" title=".',prefix,".",prefix,"-",e.name,'"></i>'):__p.push('<i class="',prefix," ",prefix,"-",e.name,'"></i>\\n'),__p.push("")}),__p.push("");return __p.join("")}}),define("util/templates",["tpl!../../templates/stitches.tpl","tpl!../../templates/downloads.tpl","tpl!../../templates/sprite.tpl","tpl!../../templates/css.tpl","tpl!../../templates/css-markup.tpl","tpl!../../templates/less.tpl","tpl!../../templates/less-markup.tpl"],function(e,t,n,r,i,s,o){"use strict";return{stitches:function(){return e.apply(this,arguments)},downloads:function(){return t.apply(this,arguments)},sprite:function(){return n.apply(this,arguments)},css:function(){return r.apply(this,arguments)},cssMarkup:function(){return i.apply(this,arguments)},less:function(){return s.apply(this,arguments)},lessMarkup:function(){return o.apply(this,arguments)}}}),define("manager/file",["wrap/jquery","util/util"],function(e,t){"use strict";return{total:0,processed:0,queue:[],set:function(e){e=e||{},this.onload=e.onload||t.noop,this.onprogress=e.onprogress||t.noop,this.onerror=e.onerror||t.noop},processFiles:function(t){var n=this;this.total=t.length,this.processed=0,this.queue=[],e.map(t,function(e){/jpeg|png|gif/.test(e.type)&&n.processFile(e)}),this.onprogress(0,"info")},processFile:function(e){var t=this,n;try{n=new FileReader,n.onloadend=function(n){var r=e.name,i=n.target.result,s=++t.processed/t.total;t.onprogress(s),t.queue.push([r,i]),t.queue.length===t.total&&t.processQueue()},n.readAsDataURL(e)}catch(r){this.onerror(r)}},processQueue:function(){var t=this;e.map(this.queue,function(e){t.onload.apply(t,e)})}}}),define("layout/base",["wrap/jquery"],function(e){"use strict";var t={maxPass:2},n=function(n){this.settings=e.extend({},t,n)};return n.prototype={constructor:n,getDimensions:function(e,t){},placeSprite:function(e,t,n){},intersection:function(t,n){var r,i,s,o,u=[],a;return e.map(n,function(e){r=e.x<t.x+t.width,s=e.y<t.y+t.height,i=e.x+e.width>t.x,o=e.y+e.height>t.y,r&&i&&s&&o&&u.push(e)}),u.length&&(a=u.pop()),a}},n}),define("layout/compact",["wrap/jquery","util/util","layout/base"],function(e,t,n){"use strict";var r={maxPass:2},i=function(t){this.settings=e.extend({},r,t)};return t.inherit(i,n,{getDimensions:function(t,n){var r=0,i=0,s=0,o=0;return e.map(t,function(e){r=e.width>r?e.width:r,i=e.height>i?e.height:i,s+=e.area}),o=Math.ceil(Math.sqrt(s)),r=r>o?r:o,i=i>o?i:o,{width:r||n.width,height:i||n.height}},placeSprite:function(e,t,n){var r,i=0,s=0,o=0;while(i++<this.settings.maxPass){for(o=0;o<=n.height-e.height;o++){for(s=0;s<=n.width-e.width;s++){e.x=s,e.y=o,r=this.intersection(e,t);if(!r)return t.push(e),e.show(),!0;s=r.x+r.width-1}o=r.y+r.height-1}n.width+=e.width,n.height+=e.height}}}),i}),define("layout/vertical",["wrap/jquery","util/util","layout/base"],function(e,t,n){"use strict";var r={maxPass:2},i=function(t){this.settings=e.extend({},r,t)};return t.inherit(i,n,{getDimensions:function(t,n){var r=0,i=0;return e.map(t,function(e){r=e.width>r?e.width:r,i+=e.height}),{width:r||n.width,height:i||n.height}},placeSprite:function(e,t,n){var r,i=0,s=0,o=0;while(i++<this.settings.maxPass){for(o=0;o<=n.height-e.height;o++){e.x=s,e.y=o,r=this.intersection(e,t);if(!r)return t.push(e),e.show(),!0;o=r.y+r.height-1}n.width+=e.width,n.height+=e.height}return!1}}),i}),define("layout/horizontal",["wrap/jquery","util/util","layout/base"],function(e,t,n){"use strict";var r={maxPass:2},i=function(t){this.settings=e.extend({},r,t)};return t.inherit(i,n,{getDimensions:function(t,n){var r=0,i=0;return e.map(t,function(e){i=e.height>i?e.height:i,r+=e.width}),{width:r||n.width,height:i||n.height}},placeSprite:function(e,t,n){var r,i=0,s=0,o=0;while(i++<this.settings.maxPass){for(s=0;s<=n.width-e.width;s++){e.x=s,e.y=o,r=this.intersection(e,t);if(!r)return t.push(e),e.show(),!0;s=r.x+r.width-1}n.width+=e.width,n.height+=e.height}return!1}}),i}),define("manager/layout",["wrap/jquery","layout/compact","layout/vertical","layout/horizontal"],function(e,t,n,r){"use strict";var i={compact:t,vertical:n,horizontal:r};return{set:function(e){var t=i[e]||i.compact;this.manager=new t},getDimensions:function(e,t){return this.manager.getDimensions(e,t)},placeSprites:function(t,n,r,i){var s=this;i(0,"info"),e.map(t,function(e){e.placed||(e.placed=s.manager.placeSprite(e,n,r)),i(n.length/t.length)}),t=e.map(t,function(e){return e.placed?null:e})},trim:function(t,n){var r=0,i=0;e.map(t,function(e){r=r>e.x+e.width?r:e.x+e.width,i=i>e.y+e.height?i:e.y+e.height}),n.width=r||n.width,n.height=i||n.height},getSpritesheet:function(t){var n=t.sprites,r=t.dimensions,i,s,o;i=document.createElement("canvas"),i.width=r.width,i.height=r.height;try{s=i.getContext("2d"),e.map(n,function(e){var t=e.left(),n=e.top();s.drawImage(e.image,t,n)}),o=i.toDataURL("image/png")}catch(u){this.$element.trigger("error",[u])}return o}}}),define("stylesheet/base",["wrap/jquery"],function(e){"use strict";var t={filename:"spritesheet.png"},n=function(n){this.settings=e.extend({},t,n)};return n.prototype={constructor:n,template:null,get:function(e,t,n,r){},markup:function(e,t,n){return this.template({prefix:t,sprites:e,tooltip:n})}},n}),define("stylesheet/css",["wrap/jquery","util/util","util/templates","stylesheet/base"],function(e,t,n,r){"use strict";var i={filename:"spritesheet.png"},s=function(t){this.settings=e.extend({},i,t)};return t.inherit(s,r,{template:n.cssMarkup,get:function(e,t,r,i){var s=i?t:this.settings.filename;return n.css({prefix:r,backgroundImage:s,sprites:e})}}),s}),define("stylesheet/less",["wrap/jquery","util/util","util/templates","stylesheet/base"],function(e,t,n,r){"use strict";var i={filename:"spritesheet.png"},s=function(t){this.settings=e.extend({},i,t)};return t.inherit(s,r,{template:n.lessMarkup,get:function(e,t,r,i){var s=i?t:this.settings.filename;return n.less({prefix:r,backgroundImage:s,sprites:e})}}),s}),define("manager/stylesheet",["wrap/jquery","stylesheet/css","stylesheet/less"],function(e,t,n){"use strict";var r={css:t,less:n};return{set:function(e){var t;this.type=e||"css",t=r[this.type],this.manager=new t},getStylesheet:function(e){var t=e.sprites,n=e.spritesheet,r=e.prefix,i=e.uri,s=this.manager.get(t,n,r,i);return s=s.replace(/\\n/g,"\n"),s},getMarkup:function(e){var t=e.sprites,n=e.prefix,r=e.tooltip||!1,i=this.manager.markup(t,n,r);return i=i.replace(/\\n/g,"\n"),i}}}),define("module/drop-box",["wrap/jquery","util/util"],function(e,t){"use strict";var n={},r=function(t,r){this.$element=e(t),this.$overlay=this.$element.find(".stitches-overlay"),this.settings=e.extend({},n,r),this.init()};return r.classname=".stitches-drop-box",r.prototype={constructor:r,init:function(){this.bind()},bind:function(){var n=this.$element.get(0),r=this.$overlay.get(0);n.addEventListener("dragenter",e.proxy(this.dragStart,this),!1),r.addEventListener("dragleave",e.proxy(this.dragStop,this),!1),r.addEventListener("dragexit",e.proxy(this.dragStop,this),!1),r.addEventListener("dragover",t.noop,!1),r.addEventListener("drop",e.proxy(this.drop,this),!1)},dragStart:function(e){this.$element.trigger("close-palettes"),this.$element.trigger("show-overlay")},dragStop:function(t){e.contains(this.$element,t.target)&&this.$element.trigger("hide-overlay")},drop:function(e){var t=e.files||e.dataTransfer.files;e.stopPropagation(),e.preventDefault(),t.length?this.$element.trigger("process-files",[t]):this.$element.trigger("hide-overlay")}},r}),define("util/array",["wrap/jquery"],function(e){"use strict";return{remove:function(t,n){return e(t).filter(function(){return this!==n})}}}),define("module/sprite",["wrap/jquery","util/util","util/templates"],function(e,t,n){"use strict";var r={name:"",src:"",padding:0},i=function(n,i){this.settings=e.extend({},r,n),this.$element=null,this.name=this.cleanName(this.settings.name),this.src=this.settings.src,this.padding=parseInt(this.settings.padding,10),this.active=!1,this.placed=!1,this.onload=i.onload||t.noop,this.init()};return i.classname=".stitches-sprite",i.prototype={constructor:i,init:function(){this.load()},load:function(){var e=this;this.image=new Image,this.image.onload=function(){e.x=0,e.y=0,e.width=e.image.width+e.padding*2,e.height=e.image.height+e.padding*2,e.area=e.width*e.height,e.render(),e.bind(),e.toDataURL(),e.onload(e)},this.image.src=this.src},render:function(){var t=n.sprite(this);this.$element=e(t),this.$element.data("sprite",this)},bind:function(){this.$element.on("click",e.proxy(this.click,this))},toDataURL:function(){var e,t,n;e=document.createElement("canvas"),e.width=this.image.width,e.height=this.image.height;try{t=e.getContext("2d"),t.drawImage(this.image,0,0),n=e.toDataURL("image/png")}catch(r){this.$element.trigger("error",[r])}this.src=n},reset:function(){this.x=0,this.y=0,this.placed=!1,this.$element.removeClass("placed")},show:function(){this.$element.css({left:this.x+"px",top:this.y+"px",padding:this.padding+"px"}).addClass("placed")},click:function(e){var t=!this.active;t?(this.$element.trigger("clear-active",[this]),this.$element.trigger("open-properties",[this])):this.$element.trigger("close-properties"),this.active=t,this.$element.toggleClass("active",t)},configure:function(e){e.padding&&(this.padding=parseInt(e.padding,10),this.width=this.image.width+this.padding*2,this.height=this.image.height+this.padding*2,this.area=this.width*this.height)},cleanName:function(e){return e=e.replace(/\.\w+$/i,""),e=e.replace(/[\s.]+/gi,"-"),e=e.replace(/[^a-z0-9\-]/gi,"_"),e},left:function(e){var n=this.x+this.padding;return e?t.toPx(-n):n},top:function(e){var n=this.y+this.padding;return e?t.toPx(-n):n},toJSON:function(){return{name:this.name,src:this.src}}},i}),define("module/canvas",["wrap/jquery","util/util","util/array","manager/layout","module/sprite"],function(e,t,n,r,i){"use strict";var s={images:null,dimensions:{width:400,height:400}},o=function(n,r,i){this.$element=e(n),this.settings=e.extend({},s,r),this.images=this.settings.images,this.dimensions=this.settings.dimensions,this.sprites=[],this.names=[],this.onprogress=i.onprogress||t.noop};return o.classname=".stitches-canvas",o.prototype={constructor:o,init:function(){this.reset=t.debounce(this.reset,500),this.bind(),this.setup(),this.reset()},bind:function(){this.$element.on("clear-active",e.proxy(this.clearActive,this))},setup:function(){var t=this;e(this.images).each(function(){var n=e(this),r=n.data("name"),i=n.attr("src");t.createSprite(r,i)}).remove()},reset:function(){this.$element.trigger("show-overlay"),this.measure(this.sprites),this.place(this.sprites),this.cut(this.sprites),this.$element.trigger("generate-sheets"),this.$element.trigger("hide-overlay")},measure:function(e){this.dimensions=r.getDimensions(e,this.settings.dimensions)},place:function(t){var n=[];e.map(t,function(e){e.reset()}),t=t.sort(function(e,t){return e.name===t.name?0:e.name>t.name?1:-1}),r.placeSprites(t,n,this.dimensions,this.onprogress)},cut:function(e){r.trim(e,this.dimensions),this.$element.css({width:this.dimensions.width+"px",height:this.dimensions.height+"px"})},add:function(e){this.sprites.push(e),this.names.push(e.name),this.$element.trigger("show-overlay"),e.$element.appendTo(this.$element),this.$element.trigger("update-toolbar"),this.reset()},remove:function(e){this.sprites=n.remove(this.sprites,e),this.names=n.remove(this.names,e.name),this.$element.trigger("show-overlay"),e.$element.fadeOut("fast").remove(),this.$element.trigger("update-toolbar"),this.$element.trigger("close-properties"),this.reset()},clear:function(){this.empty(),this.$element.trigger("show-overlay"),this.$element.trigger("update-toolbar"),this.$element.trigger("close-properties"),this.$element.trigger("open-settings"),this.reset()},empty:function(){this.sprites=[],this.names=[],this.$element.empty()},createSprite:function(e,t){var n=this,r=new i({name:e,src:t,padding:this.settings.padding},{onload:function(e){n.add(e)}})},clearActive:function(t,n){this.$element.find(".active").each(function(){var t=e(this),r=t.data("sprite");n&&r!==n&&(t.removeClass("active"),r.active=!1)})},toJSON:function(){return{sprites:this.sprites}}},o}),define("module/toolbar",["wrap/jquery"],function(e){"use strict";var t={name:"",actions:{}},n=function(n,r){this.$element=e(n),this.settings=e.extend({},t,r),this.name=this.settings.name,this.actions=this.settings.actions,this.init()};return n.classname=".stitches-toolbar",n.prototype={constructor:n,init:function(){this.bind()},bind:function(){var t=this;e.each(this.actions,function(n,r){e.each(r,function(e,r){var i="[data-action="+n+"]",s=t.getHandler(t,r);n==="instance"?t.$element.on(e,t.getHandler(t,s)):t.$element.on(e,i,s)})})},getHandler:function(t,n){return function(r){var i=e(r.currentTarget);i.is(".disabled")?(r.stopPropagation(),r.preventDefault()):n.apply(t,arguments)}},toggleActions:function(t,n){var r=this;typeof t=="string"&&(t=t.split(" ")),e.map(t,function(e){var t=r.$element.find("[data-action="+e+"]");t.toggleClass("disabled",n)})},enable:function(e){this.toggleActions(e,!1)},disable:function(e){this.toggleActions(e,!0)}},n}),define("module/palette",["wrap/jquery","util/util","module/toolbar"],function(e,t,n){"use strict";var r={name:"",visible:!1,actions:{},fields:{}},i=function(t,n){this.$element=e(t),this.settings=e.extend({},r,n),this.name=this.settings.name,this.visible=this.settings.visible,this.actions=this.settings.actions,this.fields=this.settings.fields,this.source=null,this.init()};return i.classname=".stitches-palette",t.inherit(i,n,{init:function(){this._super("init",this,arguments),this.$element.toggleClass("in",this.visible)},bind:function(){var t=this;this._super("bind",this,arguments),e.each(this.fields,function(n,r){e.each(r,function(e,r){var i="[name="+n+"]",s=t.getHandler(t,r);t.$element.on(e,i,s)})})},open:function(){this.$element.addClass("in"),this.visible=!0},close:function(){this.$element.removeClass("in"),this.visible=!1},configure:function(t){var n=this;this.source=t.source,e.each(t.inputs,function(e,t){var r="[name="+e+"]",i=n.$element.find(r),s=i.attr("type");switch(s){case"radio":case"checkbox":i=i.removeAttr("checked").filter("[value="+t+"]"),i.attr("checked","checked");break;default:i.val(t)}})}}),i}),define("module/stitches",["wrap/jquery","wrap/modernizr","../../../libs/store/store","util/util","util/templates","manager/file","manager/layout","manager/stylesheet","module/drop-box","module/canvas","module/toolbar","module/palette"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h={layout:"compact",prefix:"sprite",padding:5,uri:!1,stylesheet:"css"},p=function(t,n){this.$element=e(t),this.settings=e.extend({},h,n),this.init()};return p.prototype={constructor:p,init:function(){this.configure(),this.render(),this.test(),this.bind(),this.setDropBox(),this.setToolbar(),this.setImages(),this.setCanvas(),this.setManagers(),this.setPalettes(),this.canvas.init()},configure:function(){var t;n&&!n.disabled&&(t=n.get("stitches-settings")),t&&(this.settings=e.extend(this.settings,t))},render:function(){var e=i.stitches({});this.$element.append(e),this.$overlay=this.$element.find(".stitches-overlay"),this.$dropBox=this.$element.find(".stitches-drop-box"),this.$toolbar=this.$element.find(".stitches-toolbar"),this.$canvas=this.$element.find(".stitches-canvas"),this.$progress=this.$element.find(".stitches-progress .progress"),this.$progressBar=this.$element.find(".stitches-progress .bar"),this.$about=this.$element.find(".stitches-about"),this.$downloads=this.$element.find(".stitches-downloads"),this.$settings=this.$element.find(".stitches-settings"),this.$properties=this.$element.find(".stitches-properties")},test:function(){this.hasFileInput=this.$element.find("input.file").length},bind:function(){this.$element.on("show-overlay",e.proxy(this.showOverlay,this)),this.$element.on("hide-overlay",e.proxy(this.hideOverlay,this)),this.$element.on("open-about",e.proxy(this.openAbout,this)),this.$element.on("close-about",e.proxy(this.closeAbout,this)),this.$element.on("open-downloads",e.proxy(this.openDownloads,this)),this.$element.on("close-downloads",e.proxy(this.closeDownloads,this)),this.$element.on("open-settings",e.proxy(this.openSettings,this)),this.$element.on("close-settings",e.proxy(this.closeSettings,this)),this.$element.on("open-properties",e.proxy(this.openProperties,this)),this.$element.on("close-properties",e.proxy(this.closeProperties,this)),this.$element.on("close-palettes",e.proxy(this.closePalettes,this)),this.$element.on("process-files",e.proxy(this.processFiles,this)),this.$element.on("update-toolbar",e.proxy(this.updateToolbar,this)),this.$element.on("update-settings",e.proxy(this.updateSettingsPalette,this)),this.$element.on("update-downloads",e.proxy(this.updateDownloadsPalette,this)),this.$element.on("generate-sheets",e.proxy(this.generateSheets,this)),this.$element.on("error",e.proxy(this.errorHandler,this))},setDropBox:function(){this.dropBox=new a(this.$dropBox)},setManagers:function(){s.set({onload:e.proxy(this.canvas.createSprite,this.canvas),onprogress:e.proxy(this.updateProgress,this)}),o.set(this.settings.layout),u.set(this.settings.stylesheet)},setImages:function(){this.images=this.$element.find("> img").get()},setCanvas:function(){this.canvas=new f(this.$canvas,{images:this.images,padding:this.settings.padding},{onprogress:e.proxy(this.updateProgress,this)})},setToolbar:function(){var e=this;this.toolbar=new l(this.$toolbar,{name:"toolbar",actions:{open:{change:function(t){var n=e.$toolbar.find("input[type=file]"),r=n.clone(!0).val(""),i=t.target.files;e.$element.trigger("process-files",[i]),n.replaceWith(r)}},settings:{click:function(t){e.$element.trigger("open-settings")}},reset:{click:function(t){e.canvas.reset()}},clear:{click:function(t){e.canvas.clear()}},downloads:{click:function(t){e.$element.trigger("open-downloads")}},about:{click:function(t){e.$element.trigger("open-about")}}}})},setPalettes:function(){var t=this,n=new c(this.$about,{name:"about",visible:!0,actions:{close:{click:function(e){this.close()}}}}),r=new c(this.$downloads,{name:"downloads",visible:!1,actions:{close:{click:function(e){this.close()}}}}),i=new c(this.$settings,{name:"settings",visible:!1,actions:{close:{click:function(e){t.$element.trigger("close-settings")}}},fields:{layout:{change:function(e){var n=this.$element.find("input[name=layout]:checked"),r=n.val();this.source.layout=r,o.set(r),t.updateSettings()}},stylesheet:{change:function(e){var n=this.$element.find("input[name=stylesheet]:checked"),r=n.val();t.settings.stylesheet=r,u.set(r),t.updateSettings()}},prefix:{"input blur":function(n){var r=e(n.currentTarget).val();this.source.prefix=r,t.updateSettings()}},padding:{"input blur":function(n){var r=e(n.currentTarget).val();this.source.padding=r,t.canvas.padding=r,e.map(t.canvas.sprites,function(e){e.configure({padding:r})}),t.updateSettings()}},uri:{change:function(n){var r=e(n.currentTarget).is(":checked");this.source.uri=r,t.updateSettings()}},"import":{blur:function(n){var r=e(n.currentTarget),i=r.parents(".control-group"),s=r.val(),o;i.removeClass("error");if(s)try{o=JSON.parse(s),t.importData(o)}catch(u){i.addClass("error"),t.$element.trigger("error",[u])}else t.updateProgress(1,"success")}}}}),s=new c(this.$properties,{name:"properties",visible:!1,actions:{close:{click:function(e){t.$element.trigger("close-properties")}},remove:{click:function(e){var n=this.source;t.canvas.remove(n)}}},fields:{name:{"input blur":function(t){var n=e(t.currentTarget),r=this.source,i=n.val(),s=r.cleanName(i);this.source.name=s,i!==s&&n.val(s)}}}});this.palettes={about:n,downloads:r,settings:i,properties:s}},updateSettings:function(){this.showOverlay(),this.canvas.reset(),n&&!n.disabled&&n.set("stitches-settings",this.settings)},showOverlay:function(e){this.$overlay.fadeTo("fast",.4)},hideOverlay:function(e){this.$overlay.fadeOut("fast")},openAbout:function(e){this.closePalettes(),this.palettes.about.open()},closeAbout:function(e){this.palettes.about.visible&&this.palettes.about.close()},openDownloads:function(e){this.closePalettes(),this.palettes.downloads.open()},closeDownloads:function(e){this.palettes.downloads.visible&&this.palettes.downloads.close()},openSettings:function(e){this.closePalettes(),this.palettes.settings.configure({source:this.settings,inputs:{layout:this.settings.layout,stylesheet:this.settings.stylesheet,prefix:this.settings.prefix,padding:this.settings.padding,uri:this.settings.uri}}),this.palettes.settings.open()},closeSettings:function(e){var t=this.$settings.find("ul.nav-tabs"),n=t.find("li:first-child a"),r=this.$settings.find(":input[name=import]"),i=r.parents(".control-group");n.click(),r.val(""),i.removeClass("error"),this.palettes.settings.visible&&this.palettes.settings.close()},openProperties:function(e,t){this.closePalettes(),this.palettes.properties.configure({source:t,inputs:{name:t.name,x:t.left(),y:t.top()}}),this.palettes.properties.open()},closeProperties:function(e){this.palettes.properties.visible&&(this.palettes.properties.close(),this.canvas.$element.trigger("clear-active",[!0]))},closePalettes:function(e){this.closeAbout(),this.closeDownloads(),this.closeSettings(),this.closeProperties()},processFiles:function(e,t){s.processFiles(t)},updateToolbar:function(e){var t=this.toolbar,n=this.canvas;n.sprites.length?t.enable("reset clear downloads"):t.disable("reset clear downloads"),this.hasFileInput?t.enable("open"):t.disable("open")},updateSettingsPalette:function(e){var t=this.$settings.find(".downloads-export");t.attr({href:"data:text/plain,"+encodeURIComponent(JSON.stringify(this)),target:"_blank"})},updateDownloadsPalette:function(t){var n=this.$downloads.find("section"),r=this.$downloads.find(".downloads-spritesheet"),s=this.$downloads.find(".downloads-stylesheet"),o=i.downloads({prefix:this.settings.prefix,spritesheet:this.spritesheet,stylesheet:this.stylesheet,stylesheetWithUri:this.stylesheetWithUri,stylesheetType:u.type,stylesheetLines:this.stylesheet.split("\n").length,markup:this.markup,markupLines:this.markup.split("\n").length,markupTooltip:this.markupTooltip});n.html(o),r.attr({href:this.spritesheet,target:"_blank"}),s.attr({href:"data:text/plain,"+encodeURIComponent(this.stylesheet),target:"_blank"}),e.fn.tooltip&&n.find("[data-toggle=tooltip]").tooltip()},updateProgress:function(e,t){var n=Math.ceil(e*100);n===100&&t!=="danger"&&t!=="warning"&&(t="success"),t&&this.$progress.attr({"class":"progress progress-"+t}),this.$progressBar.css({width:n+"%"})},generateSheets:function(e){this.spritesheet=o.getSpritesheet({sprites:this.canvas.sprites,dimensions:this.canvas.dimensions}),this.stylesheetWithUri=u.getStylesheet({sprites:this.canvas.sprites,spritesheet:this.spritesheet,prefix:this.settings.prefix,uri:!0}),this.markup=u.getMarkup({sprites:this.canvas.sprites,prefix:this.settings.prefix}),this.markupTooltip=u.getMarkup({sprites:this.canvas.sprites,prefix:this.settings.prefix,tooltip:!0}),this.settings.uri?this.stylesheet=this.stylesheetWithUri:this.stylesheet=u.getStylesheet({sprites:this.canvas.sprites,spritesheet:this.spritesheet,prefix:this.settings.prefix,uri:this.settings.uri}),this.$element.trigger("update-toolbar"),this.$element.trigger("update-settings"),this.$element.trigger("update-downloads"),this.updateProgress(1,"success")},errorHandler:function(e,t,n){this.updateProgress(1,n||"warning")},toJSON:function(){return{settings:this.settings,canvas:this.canvas.toJSON()}},importData:function(t){var n=this,r=t.settings||{},i=t.canvas||{},s=i.sprites||[];this.settings=e.extend({},h,r),o.set(this.settings.layout),u.set(this.settings.stylesheet),this.updateSettings(),this.canvas.clear(),this.canvas.settings.padding=this.settings.padding,e.map(s,function(e){n.canvas.createSprite(e.name,e.src)}),this.updateProgress(1,"success")}},p}),require({paths:{tpl:"../tpl"}},["wrap/jquery","module/stitches"],function(e,t){"use strict";e(document).ready(function(){var n=".stitches";e(n).each(function(){var e=new t(this)})})}),define("stitches",function(){});